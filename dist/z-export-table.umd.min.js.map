{"version":3,"file":"z-export-table.umd.min.js","sources":["../src/core/z.export.table.ts"],"sourcesContent":["import {ToExcelOption} from \"./option\";\r\n\r\nconst  defaultCss = `table {width: 80%;border-collapse: collapse;margin: auto;} th,td {padding: 10px;text-align: center;font-family: Arial, sans-serif;}`;\r\nconst defaultOption: ToExcelOption = {\r\n    needDefaultCss: true,\r\n    userCss: \"\",\r\n    filename: \"导出表格\"\r\n}\r\n\r\nexport class ZExportTable{\r\n    static exportTableToExcel(tableHTML: string, option: ToExcelOption) {\r\n        //防止数字字符串变公式\r\n        const processedTableHTML = tableHTML.replace(\r\n            /(<td[^>]*>)(\\+?\\d[\\d\\- ]+)(<\\/td>)/g,\r\n            '$1\\'$2$3'\r\n        );\r\n\r\n        //使用传入进的option的属性值覆盖默认的属性值并生成一个新option\r\n        option = Object.assign({}, defaultOption, option);\r\n        // 创建完整的HTML页面内容\r\n        const fullHTML = `\r\n        <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\" lang=\"\">\r\n        <head>\r\n            <!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>\r\n            <x:Name>{sheetname}</x:Name>\r\n            <x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>\r\n            </x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]-->\r\n            <title></title>\r\n            <style>\r\n                ${option.needDefaultCss ? defaultCss : \"\"}\r\n                ${option.userCss}\r\n            </style>\r\n        </head>\r\n        <body>\r\n            ${processedTableHTML}\r\n        </body>\r\n        </html>\r\n    `;\r\n        const url = URL.createObjectURL(new Blob([fullHTML], {\r\n            type: 'application/vnd.ms-excel'\r\n        }));\r\n        // 创建一个 <a> 标签\r\n        const a = document.createElement('a');\r\n        a.href = url;         // 设置下载的文件地址\r\n        a.download = option.filename || '下载文件'; // 设置下载的文件名\r\n\r\n        // 触发点击事件\r\n        document.body.appendChild(a);\r\n        a.click();\r\n\r\n        // 清理资源\r\n        document.body.removeChild(a);\r\n        URL.revokeObjectURL(url);\r\n    }\r\n}"],"names":["defaultOption","needDefaultCss","userCss","filename","ZExportTable","exportTableToExcel","tableHTML","option","processedTableHTML","replace","Object","assign","fullHTML","concat","url","URL","createObjectURL","Blob","type","a","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL"],"mappings":"oPAEA,IACMA,EAA+B,CACjCC,gBAAgB,EAChBC,QAAS,GACTC,SAAU,QAGdC,EAAA,WAAA,SAAAA,IA6CC,CAAD,OA5CWA,EAAAC,mBAAP,SAA0BC,EAAmBC,GAEzC,IAAMC,EAAqBF,EAAUG,QACjC,sCACA,WAIJF,EAASG,OAAOC,OAAO,CAAE,EAAEX,EAAeO,GAE1C,IAAMK,EAAW,2iBASPC,OAAAN,EAAON,eA3BL,sIA2BmC,GACrC,sBAAAY,OAAAN,EAAOL,QAAO,yEAAAW,OAIlBL,EAAkB,4CAIlBM,EAAMC,IAAIC,gBAAgB,IAAIC,KAAK,CAACL,GAAW,CACjDM,KAAM,8BAGJC,EAAIC,SAASC,cAAc,KACjCF,EAAEG,KAAOR,EACTK,EAAEI,SAAWhB,EAAOJ,UAAY,OAGhCiB,SAASI,KAAKC,YAAYN,GAC1BA,EAAEO,QAGFN,SAASI,KAAKG,YAAYR,GAC1BJ,IAAIa,gBAAgBd,IAE3BV,CAAD"}